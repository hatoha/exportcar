/**
 * Auto Combined / Minified / Compressed js, do NOT attempt to edit
 * this file directly, see user manual for tips.
 * 
 * Contains files: 
 * geo_templates/default/external/js/system/browsing/all_tab.js | geo_templates/default/external/js/gjmain.js | geo_templates/default/external/js/plugins/utility.js | geo_templates/default/external/js/plugins/simpleCarousel.js | geo_templates/default/external/js/plugins/lightbox.js | geo_templates/default/external/js/plugins/imageFade.js | geo_templates/default/external/js/plugins/progress.js | geo_templates/default/external/js/plugins/tabs.js | geo_templates/default/external/js/plugins/jQueryRotate.js | addons/geographic_navigation/regions.js
 * 
 */
jQuery(function(){jQuery('#allTab').gjTabs('onActive',function(){jQuery('#classifiedsTabContents').show();jQuery('#auctionsTabContents').show()});if(jQuery('#allTab').hasClass('activeTab')){jQuery('#classifiedsTabContents').show();jQuery('#auctionsTabContents').show()}});var gjUtil={runHeartbeat:false,inAdmin:false,ready:function(){if(typeof console!=='undefined'&&typeof console.log!=='undefined')jQuery.error=console.log;if(typeof window.IN_ADMIN!=='undefined')if(window.IN_ADMIN)gjUtil.inAdmin=true;if(gjUtil.runHeartbeat&&!gjUtil.inAdmin){jQuery.get('cron.php?action=cron');gjUtil.runHeartbeat=false};jQuery('select.browse_sort_dropdown').change(gjUtil.browseSortChange);jQuery('.openLightboxLink').click(function(){jQuery(document).gjLightbox('get',jQuery(this).attr('href'));return false});gjUtil.initRWD();gjUtil.lightbox.initClick();gjUtil.leveledFields.init(jQuery(document));gjUtil.searchCategory.init();jQuery('.gj_image_fade').gjImageFade();jQuery('.section-collapser').click(function(){var isCollapsed=jQuery(this).hasClass('section-collapser-expanded');jQuery(this).toggleClass('section-collapser-expanded',!isCollapsed).next().toggleClass('expand',!isCollapsed)});gjUtil.initSocialHovers();gjUtil.initTagSearch();gjUtil.initDatePicker();jQuery('ul.tabList').gjTabs()},load:function(){gjUtil.initGallery();gjUtil.initImgGallery();gjUtil.initCarousel()},getCookie:function(sName){var aCookie=document.cookie.split('; ');for(var i=0;i<aCookie.length;i++){var aCrumb=aCookie[i].split('=');if(sName==aCrumb[0])return unescape(aCrumb[1])};return null},initRWD:function(){jQuery('.fixed-link').click(function(){var selector=this.hash.replace('#','.');if(!selector||!jQuery(selector).length)return false;if(jQuery(selector).is(':visible')){jQuery('.fixed-menu').hide('fast',function(){jQuery(this).css({display:''})})}else{jQuery('.fixed-menu').hide('fast');jQuery(selector).show('fast')};return false})},initGallery:function(){jQuery('.listing_set.gallery').has('.gallery_row').each(function(){jQuery(this).find('.article_inner').gj('setMaxHeight')})},initCarousel:function(){jQuery('.gj_simple_carousel .listing_set.gallery').gjSimpleCarousel();if(jQuery('.gj_carousel_keySlide').length)jQuery(document).bind('keypress',function(e){if(e.keyCode==37){jQuery('.gj_carousel_keySlide').gjSimpleCarousel('slide',{where:'left'})}else if(e.keyCode==39)jQuery('.gj_carousel_keySlide').gjSimpleCarousel('slide',{where:'right'})})},initImgGallery:function(){jQuery('.largeImageBlockLink').click(function(){var topOffset=jQuery(this.hash).offset().top-5;jQuery('html, body').animate({scrollTop:topOffset},2e3);return false});jQuery('.galleryContainer, .filmstrip_container').each(function(){$this=jQuery(this);var bigImg=$this.find('.bigLeadImage, .filmstrip_main_img'),bigDesc=$this.find('.imageTitle');$this.find('.thumb').each(function(){jQuery(this).click(function(){var txtNode=jQuery(this).next(),bigClass=txtNode.prop('id'),txt=txtNode.html();bigImg.find('a:visible').hide();bigImg.find('a.'+bigClass).show();bigDesc.html(txt)});jQuery(this).hover(function(){jQuery(this).click()},function(){})});$this.find('.galleryBigImage').width($this.find('.galleryBigImage img').gj('getMaxWidth'));if($this.find('.galleryBigImage').length){var tallestBig=0;$this.find('.bigLeadImage a > img').each(function(){tallestBig=Math.max(tallestBig,jQuery(this).outerHeight())});$this.find('.bigLeadImage a').each(function(){tallestBig=Math.max(tallestBig,jQuery(this).outerHeight())});$this.find('.bigLeadImage').css({'min-height':(tallestBig+1)+'px'})};if($this.find('.filmstrip_strip_container').length){var tallestThumb=90;$this.find('.filmstrip_entry').each(function(){tallestThumb=Math.max(tallestThumb,jQuery(this).outerHeight())});var mainFilmBuffer=$this.find('.filmstrip_main_img').outerWidth(true)-$this.find('.filmstrip_main_img').innerWidth();mainFilmBuffer=mainFilmBuffer+$this.find('.filmstrip_main_img img').outerWidth(true)-$this.find('.filmstrip_main_img img').innerWidth();$this.find('.filmstrip_main').width($this.find('.filmstrip_main img').gj('getMaxWidth')+mainFilmBuffer);$this.find('.filmstrip_strip_container').height(tallestThumb);var tallestBig=0;$this.find('.filmstrip_main_img a>img').each(function(){tallestBig=Math.max(tallestBig,jQuery(this).outerHeight())});$this.find('.filmstrip_main_img a').each(function(){tallestBig=Math.max(tallestBig,jQuery(this).outerHeight())});$this.find('.filmstrip_main_img').css({'min-height':(tallestBig+1)+'px'});var innerWidth=$this.find('.filmstrip_strip').outerWidth(),windowWidth=$this.find('.filmstrip_strip_container').innerWidth(),hideScroll=function(elem){elem.css({opacity:'0.2',cursor:'default'}).addClass('no_hover')},showScroll=function(elem){elem.css({opacity:'1',cursor:'pointer'}).removeClass('no_hover')},leftB=$this.find('.filmstripLeftScrollButton'),rightB=$this.find('.filmstripRightScrollButton');if(innerWidth<windowWidth){hideScroll(leftB);hideScroll(rightB)}else{var overflow=innerWidth-windowWidth,updateB=function(filmstrip){if(typeof filmstrip=='undefined')var filmstrip=jQuery(this).closest('.filmstrip_container').find('.filmstrip_strip');var d=filmstrip.position().left;if(d==0){hideScroll(leftB);showScroll(rightB)}else if((d*-1)==overflow){showScroll(leftB);hideScroll(rightB)}else{showScroll(leftB);showScroll(rightB)}};updateB($this.find('.filmstrip_strip'));var speed=100;leftB.hover(function(){var filmstrip=jQuery(this).closest('.filmstrip_container').find('.filmstrip_strip'),d=filmstrip.position().left;if(d==0)return;var duration=(d*-1e3)/speed;filmstrip.filter(':not(:animated)').animate({left:'0px'},{duration:duration,complete:updateB})},function(){jQuery(this).closest('.filmstrip_container').find('.filmstrip_strip').stop(true,false);updateB(jQuery(this).closest('.filmstrip_container').find('.filmstrip_strip'))});rightB.hover(function(){var filmstrip=jQuery(this).closest('.filmstrip_container').find('.filmstrip_strip'),d=(-1*overflow)-filmstrip.position().left;if(d==0)return;var duration=(d*-1e3)/speed;filmstrip.filter(':not(:animated)').animate({left:'-'+overflow+'px'},{duration:duration,complete:updateB})},function(){jQuery(this).closest('.filmstrip_container').find('.filmstrip_strip').stop(true,false);updateB(jQuery(this).closest('.filmstrip_container').find('.filmstrip_strip'))})}}})},initSocialHovers:function(){jQuery("#social_hovers li a strong").css({opacity:0,display:''});jQuery("#social_hovers li").hover(function(){jQuery(this).stop().fadeTo(500,1).siblings().stop().fadeTo(500,0.2);jQuery(this).find('a strong').stop().animate({opacity:1,top:'-10px'},300)},function(){jQuery(this).stop().fadeTo(500,1).siblings().stop().fadeTo(500,1);jQuery(this).find('a strong').stop().animate({opacity:0,top:'-1px'},300)})},initTagSearch:function(){if(!jQuery('.tagSearchField').length)return;jQuery('.tagSearchField').autocomplete({source:function(request,response){jQuery.getJSON('AJAX.php?controller=ListingTagAutocomplete&action=getSuggestions',{tags:request.term,showCounts:1},response)},select:function(event,ui){jQuery(this).val(ui.item.value).closest('form').submit()}})},initDatePicker:function(){jQuery('.dateInput,.datepicker').attr('placeholder',gjUtil._dateDefaultText).datepicker({dateFormat:'yy-mm-dd'})},browseSortChange:function(){jQuery(this).find('option:selected').each(function(){var href=jQuery(this).parent('select').prev('a').get(0).href;if(href.indexOf('?')==-1)href+='?c=';href+=jQuery(this).val();window.location.href=href})},autoSubmitForm:function(form,replaceTxt){jQuery(function(){setTimeout(function(){var myForm=jQuery('#'+form);if(myForm&&myForm.length){if(replaceTxt)window.location.replace(replaceTxt);myForm.submit()}},2e3)})},searchCategory:{_onComplete:[],init:function(){jQuery('#adv_searchCat').on('change',gjUtil.searchCategory.categoryChange);gjUtil.searchCategory.onComplete(function(){gjUtil.leveledFields.init(jQuery('#catQuestions'));gjUtil.initDatePicker()});gjUtil.searchCategory.categoryChange()},onComplete:function(callback){if(typeof callback!=='function'){jQuery.error('Invalid callback specified, not a function.');return};gjUtil.searchCategory._onComplete[gjUtil.searchCategory._onComplete.length]=callback},categoryChange:function(){var catId=jQuery('#adv_searchCat').val();if(!catId){gjUtil.searchCategory.emptyCatFields();return};var url='AJAX.php?controller=AdvancedSearch&action=getCatFields&catId='+catId;jQuery('#catQuestions').load(url,function(resultTxt){if(!resultTxt.length){gjUtil.searchCategory.emptyCatFields();return};jQuery(this).show('slow');jQuery.each(gjUtil.searchCategory._onComplete,function(){this()})})},emptyCatFields:function(){if(jQuery('#catQuestions').is(':empty'))return;jQuery('#catQuestions').hide().empty()}},lightbox:{init:function(){jQuery(document).gjLightbox()},initClick:function(){jQuery('.lightUpImg').gjLightbox('clickLinkImg');jQuery('.lightUpLink').gjLightbox('clickLink');jQuery('.lightUpDisabled').gjLightbox('clickDisabled')},close:function(){jQuery(document).gjLightbox('close')},onOpen:function(callback){if(typeof callback!=='function'){jQuery.error('Not a valid callback function.');return};jQuery(document).gjLightbox();var data=jQuery(document).data('gjLightbox');if(!data){jQuery.error('Could not retrieve data, so not able to set next image ID');return false};data.onOpen[data.onOpen.length]=callback},onClose:function(callback){if(typeof callback!=='function'){jQuery.error('Not a valid callback function.');return};jQuery(document).gjLightbox();var data=jQuery(document).data('gjLightbox');if(!data){jQuery.error('Could not retrieve data, so not able to set next image ID');return false};data.onClose[data.onClose.length]=callback},onComplete:function(callback){if(typeof callback!=='function'){jQuery.error('Not a valid callback function.');return};jQuery(document).gjLightbox();var data=jQuery(document).data('gjLightbox');if(!data){jQuery.error('Could not retrieve data, so not able to set next image ID');return false};data.onComplete[data.onComplete.length]=callback},contents:function(){jQuery(document).gjLightbox();var data=jQuery(document).data('gjLightbox');if(!data)return null;return data.box},setNextImgId:function(id){jQuery(document).gjLightbox();var data=jQuery(document).data('gjLightbox');if(!data){jQuery.error('Could not retrieve data, so not able to set next image ID');return false};data.nextImageId=id;return true}},leveledFields:{alwaysScrollToValueOnClick:false,init:function(parent){parent.find('.leveled_value').click(gjUtil.leveledFields.valueClick);var currentSelected=parent.find('input.leveled_radio:checked').closest('.leveled_value');currentSelected.each(function(){gjUtil.leveledFields.selectValue(jQuery(this),true)});parent.find('.leveled_pagination a').click(function(){var url=this.href;url=url.replace(/&selected=[0-9]+/g,'');var selected=0,currentChecked=jQuery(this).closest('.leveled_level_box').find(':checked');if(currentChecked.length)selected=currentChecked.val();url=url+'&selected='+selected;jQuery(this).closest('.leveled_level_box').load(url,function(){gjUtil.leveledFields.init(jQuery(this))});return false});parent.find('.leveled_clear').click(gjUtil.leveledFields.clearClick)},clearClick:function(){var container=jQuery(this).closest('.leveled_level_box');container.find('input.leveled_radio:checked').attr('checked',false);container.find('.leveled_value.selected_value').removeClass('selected_value');gjUtil.leveledFields.closeAfter(container);return false},valueClick:function(){var valueBox=jQuery(this);return gjUtil.leveledFields.selectValue(valueBox,false)},selectValue:function(valueBox,scrollToValue){var radio=valueBox.find('input.leveled_radio'),valuesBox=valueBox.closest('.leveled_values');if(!valueBox.length||!radio.length||!valuesBox.length)return;valuesBox.find('.leveled_value.selected_value').removeClass('selected_value');var alreadyActive=radio.prop('checked');radio.prop('checked',true);if(scrollToValue||gjUtil.leveledFields.alwaysScrollToValueOnClick){var offset=valueBox.position().top+valuesBox.scrollTop();valuesBox.animate({scrollTop:offset+'px'},'fast')};valueBox.addClass('selected_value');var container=valuesBox.closest('.leveled_level_box'),next=container.next('.leveled_level_box'),isCat=container.closest('.leveled_cat').length;if(!alreadyActive&&isCat&&!next.length){var level=container.closest('div').find('.leveled_level_box').length;jQuery('<div/>').hide().append(jQuery('<ul class="leveled_values leveled_cat"><li class="leveled_value_empty"></li></ul>')).addClass('leveled_level_box').addClass('leveled_cat_'+level).insertAfter(container);next=container.next('.leveled_level_box')};if(next.is(':empty')||next.find('li.leveled_value_empty').length||!alreadyActive){var loadNextUrl='AJAX.php?controller=LeveledFields&action=getLevel&parent='+radio.val();if(gjUtil.inAdmin)loadNextUrl='../'+loadNextUrl+'&inAdmin=1';if(container.find('.leveled_clear').length)loadNextUrl=loadNextUrl+'&showClearSelection=1';if(isCat)loadNextUrl=loadNextUrl+'&cat=1';if(jQuery('#listing_types_allowed').length)loadNextUrl=loadNextUrl+'&listing_types_allowed='+jQuery('#listing_types_allowed').val();next.load(loadNextUrl,function(responseTxt){if(responseTxt.length){jQuery(this).show('slow');gjUtil.leveledFields.init(jQuery(this))}else jQuery(this).hide('slow');if(jQuery(this).closest('.combined_update_fields').length)geoListing.combinedUpdate(jQuery(this).closest('.combined_step_section').attr('id'))});gjUtil.leveledFields.closeAfter(next)}},closeAfter:function(elem){var next=elem.next('.leveled_level_box');if(next.length){if(next.find('li.leveled_value_empty').length==0)next.hide('slow',function(){jQuery(this).empty()});gjUtil.leveledFields.closeAfter(next)}}},imageUpload:{_ajaxUrl:'AJAX.php',_adminId:0,_userId:0,_maxImages:0,_maxUploadSize:0,_progressProps:{lineCap:'round',width:80,height:80,thickness:.2,inputColor:'#777777',fgColor:'#87CEEB',bgColor:'#DDDDDD'},_msgs:{},_pl:null,observers:function(){jQuery('.editImgageTitle').unbind('.imgTitle').on('blur.imgTitle',gjUtil.imageUpload.titleUpdate).on('keyup.imgTitle',function(e){if(e.keyCode==27){jQuery(this).text(jQuery(this).prev('input').val()).blur()}else if(e.keyCode==13)jQuery(this).blur()});jQuery('.editImageSort').unbind('.imgSort').on('blur.imgSort',gjUtil.imageUpload.sortUpdate).on('keydown.imgSort',function(e){if(e.which==13){e.preventDefault();jQuery(this).blur()}}).on('keyup.imgSort',function(e){if(e.keyCode==27){jQuery(this).val(jQuery(this).attr('value'));e.preventDefault()}else if(e.keyCode==13){jQuery(this).blur();e.preventDefault()}});jQuery('.deleteImage').unbind('.imgDel').on('click.imgDel',function(e){e.preventDefault();var imgId=this.hash.replace('#','');jQuery('form').unbind('.imgSave').on('submit.imgSave',function(e){e.preventDefault()});jQuery.ajax({type:'POST',url:gjUtil.imageUpload._ajaxUrl+'?controller=UploadImage&action=delete&adminId='+gjUtil.imageUpload._adminId+'&userId='+gjUtil.imageUpload._userId,data:{image_id:imgId}}).done(function(response){jQuery('form').unbind('.imgSave');if(response.error){gjUtil.imageUpload.handleError(response.error);return};if(response.msg)gjUtil.addMessage(response.msg,2e3);if(response.preview)gjUtil.imageUpload.previewUpdate(response.preview);if(response.debug)console.log('Debug: '+response.debug)}).error(function(){jQuery('form').unbind('.imgSave');gjUtil.addError(gjUtil.imageUpload._msgs.m500682)})});jQuery('.rotateImage').unbind('.imgRot').on('click.imgRot',function(e){e.preventDefault();var imgId=this.hash.replace('#','');jQuery('form').unbind('.imgSave').on('submit.imgSave',function(e){e.preventDefault()});jQuery.ajax({type:'POST',url:gjUtil.imageUpload._ajaxUrl+'?controller=UploadImage&action=rotate&adminId='+gjUtil.imageUpload._adminId+'&userId='+gjUtil.imageUpload._userId,data:{image_id:imgId,degrees:270}}).done(function(response){jQuery('form').unbind('.imgSave');if(response.error){gjUtil.imageUpload.handleError(response.error);return};if(response.debug)console.log('Debug: '+response.debug);var previewImg=jQuery('#imagesPreview_'+imgId+' div.media-preview-image img'),currentAngle=previewImg.getRotateAngle();if(!currentAngle)currentAngle=0;var rotateTo=Math.round(1*currentAngle+90);previewImg.rotate(rotateTo);previewLink=jQuery('#imagesPreview_'+imgId+' div.media-preview-image a');if(previewLink.attr('href').length>0){if(!previewLink.data('cachebuster'))previewLink.data('cachebuster',previewLink.attr('href'));previewLink.attr('href',previewLink.data('cachebuster')+"?_="+(rotateTo%360))}}).error(function(){jQuery('form').unbind('.imgSave')})})},titleUpdate:function(){var $this=jQuery(this),title=$this.text().replace("\n",''),plain=function(txt){return jQuery('<div>').html(txt).text()};$this.text(title);var oldTitle=plain($this.prev('input').val());if(title===oldTitle)return;var imgId=$this.closest('.media-preview').attr('id').replace('imagesPreview_','');if(!imgId){$this.text(oldTitle);return};jQuery('form').unbind('.imgSave').on('submit.imgSave',function(e){e.preventDefault()});jQuery.ajax({type:'POST',url:gjUtil.imageUpload._ajaxUrl+'?controller=UploadImage&action=editTitle&adminId='+gjUtil.imageUpload._adminId+'&userId='+gjUtil.imageUpload._userId,data:{image_id:imgId,title:title,edit_title:1}}).done(function(response){jQuery('form').unbind('.imgSave');if(response.error){gjUtil.imageUpload.handleError(response.error);return};if(response.success){$this.text(plain(response.img_title)).prev('input').val(response.img_title);$this.siblings('.media-editable-saved').addClass('media-editable-saved-show');setTimeout(function(){$this.siblings('.media-editable-saved').removeClass('media-editable-saved-show')},1e3)};if(response.debug)console.log('Debug: '+response.debug)}).error(function(){jQuery('form').unbind('.imgSave');gjUtil.addError(gjUtil.imageUpload._msgs.m500689)})},sortUpdate:function(){var $this=jQuery(this),sort=$this.val(),oldSort=$this.attr('value');if(sort===oldSort)return;var imgId=$this.closest('.media-preview').attr('id').replace('imagesPreview_','');if(!imgId){$this.val(oldSort);return};jQuery('form').unbind('.imgSave').on('submit.imgSave',function(e){e.preventDefault()});jQuery.ajax({type:'POST',url:gjUtil.imageUpload._ajaxUrl+'?controller=UploadImage&action=sortInput&adminId='+gjUtil.imageUpload._adminId+'&userId='+gjUtil.imageUpload._userId,data:{image_id:imgId,sort:sort}}).done(function(response){jQuery('form').unbind('.imgSave');if(response.error){gjUtil.imageUpload.handleError(response.error);return};if(response.msg)gjUtil.addMessage(response.msg,2e3);if(response.preview)gjUtil.imageUpload.previewUpdate(response.preview);if(response.debug)console.log('Debug: '+response.debug)}).error(function(){jQuery('form').unbind('.imgSave');gjUtil.addError(gjUtil.imageUpload._msgs.m500689)})},previewUpdate:function(preview){jQuery('#imagesUploaded').html(jQuery(preview)).find('.lightUpImg').gjLightbox('clickLinkImg');var currentCount=jQuery('#imagesUploaded > .media-preview').length;jQuery('#imagesCurrentCount').html(currentCount);if(currentCount>=gjUtil.imageUpload._maxImages){jQuery('#imagesPickfiles').hide('fast')}else jQuery('#imagesPickfiles').show('fast');gjUtil.imageUpload.observers()},plFilesAdded:function(up,files){var currentCount=jQuery('#imagesUploaded > .media-preview').length,maxFiles=gjUtil.imageUpload._maxImages-currentCount;if(maxFiles<files.length){filesKept=[];jQuery.each(files,function(i,file){if((i+1)>maxFiles){up.removeFile(file)}else filesKept[i]=file});files=filesKept;gjUtil.addMessage(gjUtil.imageUpload._msgs.tooManyFiles+' '+gjUtil.imageUpload._maxImages,2e3)};var dummyCss=jQuery('#imagesProgressBarCss'),props=gjUtil.imageUpload._progressProps;if(dummyCss.length){props.width=props.height=dummyCss.width()||props.width;var h=dummyCss.height()/100;if(h>0&&h<=1)props.thickness=h;props.fgColor=dummyCss.css('color')||props.fgColor;props.bgColor=dummyCss.css('backgroundColor')||props.bgColor};var thumbsStarted=0,upStarted=false;jQuery.each(files,function(i,file){if(file.status===plupload.FAILED)return;jQuery('#imagesFilelist').append('<div id="'+file.id+'" class="media-queue-entry clearfix"><div class="media-queue-progress"><input value="0" id="progress_'+file.id+'"></div><div class="queue-thumb"></div>'+file.name+' ('+plupload.formatSize(file.size)+')<div class="queue-message"></div></div>');jQuery('#progress_'+file.id).gjProgress(props);var img;img=new o.Image();img.onload=function(){img.embed(jQuery('#'+file.id+' .queue-thumb')[0],{width:80,height:80,crop:true,swf_url:mOxie.resolveUrl(up.settings.flash_swf_url),xap_url:mOxie.resolveUrl(up.settings.silverlight_xap_url)})};img.onembedded=function(){thumbsStarted--;if(!upStarted&&thumbsStarted<=0){upStarted=true;up.start()};img.destroy()};img.onerror=function(){thumbsStarted--;if(!upStarted&&thumbsStarted<=0){upStarted=true;up.start()}};thumbsStarted++;img.load(file.getSource())})},plUploadProgress:function(up,file){jQuery('#progress_'+file.id).val(file.percent).trigger('change');if(file.percent>90)jQuery('#progress_'+file.id).val('...').attr({title:gjUtil.imageUpload._msgs.m500667})},plBeforeUpload:function(up,file){up.settings.multipart_params={filename:file.name}},plError:function(up,err){gjUtil.imageUpload.handleError(err);up.refresh()},plFileUploaded:function(up,file,info){jQuery('#progress_'+file.id).val(100).trigger('change');if(info&&info.response){var response=jQuery.parseJSON(info.response);if(response.error){gjUtil.imageUpload.handleError(response.error);return};if(response.preview)gjUtil.imageUpload.previewUpdate(response.preview);if(response.msg)jQuery('#'+file.id+' .queue-message').html(response.msg);if(response.debug)console.log('Debug: '+response.debug)}else gjUtil.imageUpload.handleError({error:'null response'});setTimeout(function(){jQuery('#'+file.id).hide('slow')},500)},handleError:function(error){var msg=gjUtil.imageUpload._msgs.m500677;if(error.code!=-100){if(error.code===plupload.FILE_SIZE_ERROR){msg+=gjUtil.imageUpload._msgs.m500818+plupload.formatSize(gjUtil.imageUpload._maxUploadSize)}else msg+=gjUtil.imageUpload._msgs.m500678;msg+=' (';if(error.file)msg+=error.file.name+' : ';msg+=error.code+')'}else msg+=error.message;if(error.file)jQuery('#'+error.file.id+' .queue-message').html(msg);gjUtil.addError(msg)},init:function(){},_init:function(){jQuery('#imagesUploaded').sortable({delay:200,handle:'.slot-label',update:function(event,ui){var params=jQuery('#imagesUploaded').sortable('serialize');jQuery.ajax({type:'POST',url:gjUtil.imageUpload._ajaxUrl+'?controller=UploadImage&action=sortDrag&adminId='+gjUtil.imageUpload._adminId+'&userId='+gjUtil.imageUpload._userId,data:params}).done(function(response){if(response.error){gjUtil.addError(response.error.message+' ('+response.error.code+')');return};if(response.preview)gjUtil.imageUpload.previewUpdate(response.preview);if(response.msg)gjUtil.addMessage(response.msg,2e3);if(response.debug)console.log('Debug: '+response.debug)}).error(function(){gjUtil.addError(gjUtil.imageUpload._msgs.m500689)})}})}},_initMsg:function(){if(!jQuery('#_msgDialog').length){jQuery(document.body).append('<div id="_msgDialog">empty</div>');jQuery('#_msgDialog').dialog({autoOpen:false,show:{effect:'fade',duration:400},hide:{effect:'fade',duration:400}})};return jQuery('#_msgDialog').dialog('close')},addMessage:function(msg,autoClose){var box=gjUtil._initMsg();box.html(msg).dialog('open');if(autoClose>0)setTimeout(function(){if(box.dialog('isOpen'))box.dialog('close')},autoClose)},addError:function(msg){gjUtil.addMessage(msg)}},gjWysiwyg={editors:[],tinyLoaded:false,localStorage:false,loadTiny:function(){return false},removeTiny:function(){if(!gjWysiwyg.tinyLoaded)return;if(gjWysiwyg.editors)gjWysiwyg.editors.each(function(){var id=jQuery(this).attr('id');if(tinyMCE.getInstanceById(id))tinyMCE.execCommand('mceRemoveControl',false,id)});gjWysiwyg.tinyLoaded=false;gjWysiwyg.editors=[]},restoreTiny:function(){gjWysiwyg.loadTiny();gjWysiwyg.editors=jQuery('.editor')},toggleTinyEditors:function(){if(gjWysiwyg.loadTiny())if(gjWysiwyg.localStorage){localStorage.tinyMCE='on';return};if(gjWysiwyg.editors)gjWysiwyg.editors.each(function(){var id=jQuery(this).attr('id');if(!tinyMCE.getInstanceById(id)){tinyMCE.execCommand('mceAddControl',false,id);if(gjWysiwyg.localStorage)localStorage.tinyMCE='on'}else{tinyMCE.execCommand('mceRemoveControl',false,id);if(gjWysiwyg.localStorage)localStorage.tinyMCE='off'}})}},getCookie=gjUtil.getCookie;(function(jQuery){var methods={init:function(options){return this;return this.each(function(){var $this=jQuery(this),data=$this.data('gj');if(!data)$this.data('gj',$this.extend({},options))})},setMaxWidth:function(){return this.width(Math.max.apply(this,jQuery.map(this,function(e){return jQuery(e).width()})))},setMaxHeight:function(){return this.height(Math.max.apply(this,jQuery.map(this,function(e){return jQuery(e).height()})))},getMaxWidth:function(){return Math.max.apply(this,jQuery.map(this,function(e){return jQuery(e).width()}))},getMaxHeight:function(){return Math.max.apply(this,jQuery.map(this,function(e){return jQuery(e).height()}))},moveToMiddle:function(){return this.each(function(){var $this=jQuery(this),vpWidth=jQuery(window).width(),vpHeight=jQuery(window).height(),elWidth=$this.outerWidth()||200,elHeight=$this.height()||200;offsetLeft=0;if(vpWidth>elWidth)var offsetLeft=Math.max(0,((vpWidth-elWidth)/2)+jQuery(window).scrollLeft());var offsetTop=Math.max(0,((vpHeight-elHeight)/2)+jQuery(window).scrollTop());if($this.css('position')!='absolute')$this.css({position:'absolute'});if($this.parent().is('body'))$this.appendTo('body');var locationCss={left:offsetLeft+'px',top:offsetTop+'px'};if($this.is(':visible')){$this.animate(locationCss)}else $this.css(locationCss)})},filterValue:function(valueToCheck){if(typeof valueToCheck==='undefined')return this.hasClass('gjcheckthatwillfail');return this.filter(function(){return jQuery(this).val()==valueToCheck})}};jQuery.fn.gj=jQuery.fn.gjUtility=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments)}else jQuery.error('Method '+method+' does not exist on jQuery.gj')}}(jQuery));(function(jQuery){var methods={init:function(options){return this.each(function(){var $this=jQuery(this),data=$this.data('gjSimpleCarousel');if(!data){$this.data('gjSimpleCarousel',$this.extend({auto_slide:true,hover_pause:true,key_slide:true,auto_slide_seconds:5,dot_text:'&bull;'},options));data=$this.data('gjSimpleCarousel')};var sections=$this.find('.gallery_row').length;if(sections<2)return;var dot='<span class="gallery_carousel_dot"> '+data.dot_text+' </span>',dotActive='<span class="gallery_carousel_dot_active"> '+data.dot_text+' </span>',dots=dotActive;for(var i=1;i<$this.find('.gallery_row').length;i++)dots+=dot;if(sections<3)$this.find('.gallery_row').clone().insertAfter($this.find('.gallery_row:last'));var row_width=$this.outerWidth(true);$this.find('.gallery_row').css({display:'inline-block',width:row_width+'px'});$this.find('.leftScroll').after(dots);$this.find('.galleryScroll').show();$this.find('.leftScroll').click(function(){jQuery(this).parents('.listing_set.gallery').gjSimpleCarousel('slide',{where:'left'})});$this.find('.rightScroll').click(function(){jQuery(this).parents('.listing_set.gallery').gjSimpleCarousel('slide',{where:'right'})});$this.find('.gallery_row:first').before($this.find('.gallery_row:last'));$this.find('.gallery_inner').css({left:'-'+row_width+'px'});var slideMe=function(){$this.gjSimpleCarousel('slide',{where:'right'})};if(data.auto_slide){var timer=setInterval(slideMe,data.auto_slide_seconds*1e3);if(data.hover_pause)$this.hover(function(){clearInterval(timer)},function(){timer=setInterval(slideMe,data.auto_slide_seconds*1e3)})};if(data.key_slide)$this.addClass('gj_carousel_keySlide')})},slide:function(options){var where=options.where||'left';return this.each(function(){var $this=jQuery(this),data=$this.data('gjSimpleCarousel');if(!data){$this.gjSimpleCarousel();data=$this.data('gjSimpleCarousel');if(!data)return};var item_width=$this.find('.gallery_row').outerWidth(),left_indent=parseInt($this.find('.gallery_inner').css('left'));if(where=='left'){left_indent=left_indent+item_width}else left_indent=left_indent-item_width;$this.find('.gallery_inner:not(:animated)').animate({left:left_indent},500,function(){if(where=='left'){$this.find('.gallery_row:first').before($this.find('.gallery_row:last'));if($this.find('.gallery_carousel_dot_active').prev().is('img')){$this.find('.rightScroll').before($this.find('.gallery_carousel_dot_active'))}else $this.find('.gallery_carousel_dot_active').prev().before($this.find('.gallery_carousel_dot_active'))}else{$this.find('.gallery_row:last').after($this.find('.gallery_row:first'));if($this.find('.gallery_carousel_dot_active').next().is('img')){$this.find('.leftScroll').after($this.find('.gallery_carousel_dot_active'))}else $this.find('.gallery_carousel_dot_active').next().after($this.find('.gallery_carousel_dot_active'))};$this.find('.gallery_inner').css({left:'-'+item_width+'px'})})})}};jQuery.fn.gjSimpleCarousel=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments)}else jQuery.error('Method '+method+' does not exist on jQuery.gjSimpleCarousel')}}(jQuery));(function(jQuery){var internal={_hiddenElems:[]};internal.onOpen=function(){jQuery('object, select, embed').each(function(){if(this.style.visibility!='hidden'){this.style.visibility='hidden';internal._hiddenElems[internal._hiddenElems.length]=this}})};internal.onClose=function(){jQuery.each(internal._hiddenElems,function(){this.style.visibility='visible'});internal._hiddenElems=[]};internal.afterOpen=function(data,isNew){var alreadyOpen=!data.navBarHidden;data.box.find('a.lightUpImg').gjLightbox('clickLinkImg');data.box.find('a.lightUpLink').gjLightbox('clickLink');data.box.find('.lightUpDisabled').gjLightbox('clickDisabled');data.box.find('.lightUpBox_imageBox img,img.lightUpBigImage,.closeLightUpBox,.closeBoxX').each(function(){elem=jQuery(this);if(elem.parent().is('a.lightUpBox_link')){elem.parent('a.lightUpBox_link').on('click.gjLightbox',function(action){window.open(this.href);return false})}else elem.gjLightbox('clickClose')});jQuery.each(data.onComplete,function(){this()});gjUtil.initDatePicker();data.box.find('.lightUpBox_navigation').each(function(){slideshow.navObserver(data,jQuery(this));jQuery(this).css({opacity:alreadyOpen?0.9:0.08})});data.box.find('.disabledLink').css({opacity:0.4});if(data.box.find('.lightUpMover,.lightUpTitle').length)data.box.draggable({handle:'.lightUpMover,.lightUpTitle',opacity:0.75});if(isNew)data.box.fadeIn('slow')};var slideshow={};slideshow.navObserver=function(data,element){if(!element)return;data.navBar=element;if(data.box){data.box.on('mouseenter.gjLightbox',function(){if(data.navBar){data.navBarHidden=false;data.navBar.fadeTo('fast',0.9)}});data.box.on('mouseleave.gjLightbox',function(){if(data.navBar){data.navBarHidden=true;data.navBar.fadeTo('fast',0.08)}})};var play=data.navBar.find('a.playLink'),pause=data.navBar.find('a.pauseLink'),disabledPlay=data.navBar.find('span.noplayLink');if(!play.length||!pause.length||!disabledPlay.length)return;play.unbind('.gjLightbox');pause.unbind('.gjLightbox');play.on('click.gjLightbox',function(){jQuery(this).hide().next().show();slideshow.start(data);return false});pause.on('click.gjLightbox',function(){jQuery(this).hide().prev().show();slideshow.stop(data);return false});slideshow.initPlayPause(data)};slideshow.start=function(data){if(data.slideshowPlaying)return;data.slideshowPlaying=true;slideshow._timeout(data)};slideshow._timeout=function(data){data._slideshow=setTimeout(function(){slideshow._nextImage(data)},1e3*data.slideshowDelay)};slideshow.stop=function(data){clearTimeout(data._slideshow);data.slideshowPlaying=false;data._startUpSlideshow=false};slideshow._nextImage=function(data){if(!data.nextImageId||!data.slideshowPlaying)return;var url='get_image.php?id='+data.nextImageId+'&playing=1';data.nextImageId=0;data._startUpSlideshow=true;if(data.navBar)data.navBar.hide();jQuery(document).gjLightbox('get',url)};slideshow.initPlayPause=function(data){var play=data.navBar.find('a.playLink'),pause=data.navBar.find('a.pauseLink'),disabledPlay=data.navBar.find('span.noplayLink');if(!play.length||!pause.length||!disabledPlay.length)return;if(data.nextImageId){disabledPlay.hide();if(data.slideshowPlaying){pause.show()}else play.show()}};var methods={init:function(options){return this.each(function(){var $this=jQuery(this),data=$this.data('gjLightbox');if(!$this.is(document)){jQuery.error('This is not a valid selector.  Can only initialize the lightbox on the document.');return};if(!data){$this.data('gjLightbox',$this.extend({slideshowDelay:5,overlayOpacity:0.6,boxState:'closed',onOpen:[internal.onOpen],onClose:[internal.onClose],onComplete:[],nextImageId:0,_startUpSlideshow:false,box:jQuery('<div />',{'class':'gjLightbox'}).prependTo('body').hide(),overlay:jQuery('<div />',{'class':'gjLightboxOverlay',click:function(){$this.gjLightbox('close')}}).prependTo('body').hide()},options));data=$this.data('gjLightbox');$this.on('keydown.gjLightbox',function(e){if(e.keyCode==27)if(data.boxState=='open'){jQuery(document).gjLightbox('close');return false}});jQuery(window).resize(function(){jQuery('.gjLightboxOverlay').css({width:jQuery(document).width()+'px',height:jQuery(document).height()+'px'})})}})},destroy:function(){return this.each(function(){jQuery(this).unbind('.gjLightbox')})},get:function(href,options){return this.each(function(){var $this=jQuery(this),data=$this.data('gjLightbox');if(!href){jQuery.error('HREF link not specified, nothing to get!');return};if(!data){$this.gjLightbox();data=$this.data('gjLightbox');if(!data)return};jQuery.get(href,function(contents){$this.gjLightbox('open',contents,options);if(data._startUpSlideshow){data._startUpSlideshow=false;slideshow._timeout(data)}},'html')})},post:function(href,params,options){return this.each(function(){var $this=jQuery(this),data=$this.data('gjLightbox');if(!href){jQuery.error('HREF link not specified, nothing to get!');return};if(!data){$this.gjLightbox();data=$this.data('gjLightbox');if(!data)return};jQuery.post(href,params,function(contents){$this.gjLightbox('open',contents,options);if(data._startUpSlideshow){data._startUpSlideshow=false;slideshow._timeout(data)}},'html')})},getImg:function(href,options){return this.each(function(){var $this=jQuery(this),data=$this.data('gjLightbox');if(!href){jQuery.error('HREF link not specified, nothing to get!');return};if(!data){$this.gjLightbox();data=$this.data('gjLightbox');if(!data)return};var biggerImg=jQuery('<img />',{src:href,alt:'','class':'lightUpBigImage'});$this.gjLightbox('open',biggerImg,options)})},open:function(contents,options){return this.each(function(){var $this=jQuery(this),data=$this.data('gjLightbox'),params=jQuery.extend({useOverlay:true},options);if(!data){$this.gjLightbox();data=$this.data('gjLightbox');if(!data)return};var newBox=jQuery('<div />').html(contents);if(data.boxState=='closed'){jQuery.each(data.onOpen,function(){this()});if(params.useOverlay)data.overlay.css({width:jQuery(document).width()+'px',height:jQuery(document).height()+'px'}).fadeTo('fast',data.overlayOpacity);newImg=newBox.find('.lightUpBox_imageBox img,img.lightUpBigImage');if(newImg.length)if(newImg.width()==0)newImg.load(function(){if(data.boxState=='open')data.box.gj('moveToMiddle')});data.box.css({width:'',height:''});data.box.html(newBox).gj('moveToMiddle');internal.afterOpen(data,true)}else{var oldInner=data.box.children(':first'),borderOffset=0;if(data.box.css('box-sizing')=='border-box')borderOffset+=parseInt(data.box.css('border-left-width'))*2;var startingD={width:Math.max(150,oldInner.width())+borderOffset,height:Math.max(150,oldInner.height())+borderOffset};data.box.css({width:startingD.width+'px',height:startingD.height+'px'});oldInner.fadeOut('slow',function(){newBox.hide();data.box.html(newBox);var newImg=newBox.select('.lightUpBox_imageBox img'),morphingTime=function(){var newD={width:Math.max(150,newBox.width())+borderOffset,height:Math.max(150,newBox.height())+borderOffset};data.box.css({overflow:'hidden'});data.box.animate({width:newD.width+'px',height:newD.height+'px'},function(){data.box.css({width:'',height:''})})};if(newImg.length)if(newImg.width()>0){morphingTime()}else newImg.on('load.gjLightbox',morphingTime);internal.afterOpen(data,false);newBox.fadeIn('fast');oldInner.remove()})};data.boxState='open'})},isOpen:function(){var $this=jQuery(this),data=$this.data('gjLightbox');if(data&&data.boxState=='open')return true;return false},close:function(options){return this.each(function(){var $this=jQuery(this),data=$this.data('gjLightbox');if(!data){$this.gjLightbox();data=$this.data('gjLightbox');if(!data)return};if(data.boxState=='closed')return;data.overlay.fadeOut('fast');data.box.fadeOut('fast',function(){jQuery.each(data.onClose,function(){this()})});slideshow.stop(data);data.boxState='closed'})},clickLink:function(){return this.each(function(){jQuery(this).unbind('.gjLightbox').on('click.gjLightbox',function(){jQuery(document).gjLightbox('get',jQuery(this).attr('href'));return false})})},clickLinkImg:function(){return this.each(function(){jQuery(this).unbind('.gjLightbox').on('click.gjLightbox',function(){jQuery(document).gjLightbox('getImg',jQuery(this).attr('href'));return false})})},clickClose:function(){return this.each(function(){jQuery(this).unbind('.gjLightbox').on('click.gjLightbox',function(){jQuery(document).gjLightbox('close');return false})})},clickDisabled:function(){return this.each(function(){jQuery(this).unbind('.gjLightbox').on('click.gjLightbox',function(){return false}).css({opacity:0.3}).addClass('lightboxLinkDisabledProcessed')})},startSlideshow:function(){return this.each(function(){var $this=jQuery(this),data=$this.data('gjLightbox');if(!data){$this.gjLightbox();data=$this.data('gjLightbox');if(!data)return};slideshow.start(data)})},stopSlideshow:function(){return this.each(function(){var $this=jQuery(this),data=$this.data('gjLightbox');if(!data){$this.gjLightbox();data=$this.data('gjLightbox');if(!data)return};slideshow.stop(data)})}};jQuery.fn.gjLightbox=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments)}else jQuery.error('Method '+method+' does not exist on jQuery.gjLightbox')}}(jQuery));(function(jQuery){var methods={init:function(options){return this.each(function(){var $this=jQuery(this);if(!$this.find('div.active').length)$this.find('div:first').addClass('active');$this.find('div:not(.active)').hide();$this.find('div.active').show();setInterval(function(){var active=$this.find('div.active');if(!active.length)active=$this.find('div:last');var next=active.next().length?active.next():$this.find('div:first');active.addClass('last_active');next.addClass('active');next.fadeIn(1e3);active.fadeOut(1e3,function(){active.removeClass('active last_active')})},5e3)})}};jQuery.fn.gjImageFade=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments)}else jQuery.error('Method '+method+' does not exist on jQuery.gjImageFade')}}(jQuery));(function($){"use strict";var k={},max=Math.max,min=Math.min;k.c={};k.c.d=$(document);k.c.t=function(e){return e.originalEvent.touches.length-1};k.o=function(){var s=this;this.o=null;this.$=null;this.i=null;this.g=null;this.v=null;this.cv=null;this.x=0;this.y=0;this.$c=null;this.c=null;this.t=0;this.isInit=false;this.fgColor=null;this.pColor=null;this.dH=null;this.cH=null;this.eH=null;this.rH=null;this.scale=1;this.run=function(){var cf=function(e,conf){var k;for(k in conf)s.o[k]=conf[k];s.init();s._configure()._draw()};if(this.$.data('kontroled'))return;this.$.data('kontroled',true);this.extend();this.o=$.extend({min:this.$.data('min')||0,max:this.$.data('max')||100,stopper:true,readOnly:this.$.data('readonly'),cursor:(this.$.data('cursor')===true&&30)||this.$.data('cursor')||0,thickness:this.$.data('thickness')||0.35,lineCap:this.$.data('linecap')||'butt',width:this.$.data('width')||200,height:this.$.data('height')||200,displayInput:this.$.data('displayinput')==null||this.$.data('displayinput'),displayPrevious:this.$.data('displayprevious'),fgColor:this.$.data('fgcolor')||'#87CEEB',inputColor:this.$.data('inputcolor')||this.$.data('fgcolor')||'#87CEEB',inline:false,step:this.$.data('step')||1,draw:null,change:null,cancel:null,release:null,error:null},this.o);if(this.$.is('fieldset')){this.v={};this.i=this.$.find('input');this.i.each(function(k){var $this=$(this);s.i[k]=$this;s.v[k]=$this.val()});this.$.find('legend').remove()}else{this.i=this.$;this.v=this.$.val();(this.v=='')&&(this.v=this.o.min)};(!this.o.displayInput)&&this.$.hide();this.$c=$(document.createElement('canvas')).attr({width:this.o.width,height:this.o.height});if(typeof G_vmlCanvasManager!=='undefined')G_vmlCanvasManager.initElement(this.$c[0]);this.c=this.$c[0].getContext?this.$c[0].getContext('2d'):null;if(!this.c){this.o.error&&this.o.error();return};if(this.$.is('fieldset')){this.i.each(function(k){$this.bind('change',function(){var val={};val[k]=$this.val();s.val(val)})})}else this.$.bind('change',function(){s.val(s._validate(s.$.val()))});this.$.wrap($('<div style="'+(this.o.inline?'display:inline;':'')+'width:'+this.o.width+'px;height:'+this.o.height+'px;"></div>')).before(this.$c);this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1);if(this.scale!==1){this.$c[0].width=this.$c[0].width*this.scale;this.$c[0].height=this.$c[0].height*this.scale;this.$c.width(this.o.width);this.$c.height(this.o.height)};if(this.v instanceof Object){this.cv={};this.copy(this.v,this.cv)}else this.cv=this.v;this.$.bind("configure",cf).parent().bind("configure",cf);this._listen()._configure()._xy().init();this.isInit=true;this._draw();return this};this._draw=function(){var d=true;s.g=s.c;s.clear();s.dH&&(d=s.dH());(d!==false)&&s.draw()};this._touch=function(e){return this};this._mouse=function(e){return this};this._xy=function(){var o=this.$c.offset();this.x=o.left;this.y=o.top;return this};this._listen=function(){return this};this._configure=function(){if(this.o.draw)this.dH=this.o.draw;if(this.o.change)this.cH=this.o.change;if(this.o.cancel)this.eH=this.o.cancel;if(this.o.release)this.rH=this.o.release;if(this.o.displayPrevious){this.pColor=this.h2rgba(this.o.fgColor,"0.4");this.fgColor=this.h2rgba(this.o.fgColor,"0.6")}else this.fgColor=this.o.fgColor;return this};this._clear=function(){this.$c[0].width=this.$c[0].width};this._validate=function(v){return(~~(((v<0)?-0.5:0.5)+(v/this.o.step)))*this.o.step};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(v){};this.val=function(v){};this.xy2val=function(x,y){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(h,a){var rgb;h=h.substring(1,7);rgb=[parseInt(h.substring(0,2),16),parseInt(h.substring(2,4),16),parseInt(h.substring(4,6),16)];return"rgba("+rgb[0]+","+rgb[1]+","+rgb[2]+","+a+")"};this.copy=function(f,t){for(var i in f)t[i]=f[i]}};k.Dial=function(){k.o.call(this);this.startAngle=null;this.xy=null;this.radius=null;this.lineWidth=null;this.cursorExt=null;this.w2=null;this.PI2=2*Math.PI;this.extend=function(){this.o=$.extend({bgColor:this.$.data('bgcolor')||'#EEEEEE',angleOffset:this.$.data('angleoffset')||0,angleArc:this.$.data('anglearc')||360,inline:true},this.o)};this.val=function(v){if(null!=v){this.cv=this.o.stopper?max(min(v,this.o.max),this.o.min):v;this.v=this.cv;this.$.val(this.v+'%');this._draw()}else return this.v};this.xy2val=function(x,y){var a,ret;a=Math.atan2(x-(this.x+this.w2),-(y-this.y-this.w2))-this.angleOffset;if(this.angleArc!=this.PI2&&(a<0)&&(a>-0.5)){a=0}else if(a<0)a+=this.PI2;ret=~~(0.5+(a*(this.o.max-this.o.min)/this.angleArc))+this.o.min;this.o.stopper&&(ret=max(min(ret,this.o.max),this.o.min));return ret};this.listen=function(){};this.init=function(){if(this.v<this.o.min||this.v>this.o.max)this.v=this.o.min;this.$.val(this.v);this.w2=this.o.width/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2*this.scale;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;this.o.displayInput&&this.i.css({width:((this.o.width/2+4)>>0)+'px',height:((this.o.width/3)>>0)+'px',position:'absolute','vertical-align':'middle','margin-top':((this.o.width/3)>>0)+'px','margin-left':'-'+((this.o.width*3/4+2)>>0)+'px',border:0,background:'none',font:'bold 1em Arial','text-align':'center',color:this.o.inputColor||this.o.fgColor,padding:'0px','-webkit-appearance':'none'})||this.i.css({width:'0px',visibility:'hidden'})};this.change=function(v){this.cv=v;this.$.val(v)};this.angle=function(v){return(v-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.draw=function(){var c=this.g,a=this.angle(this.cv),sat=this.startAngle,eat=sat+a,sa,ea,r=1;c.lineWidth=this.lineWidth;c.lineCap=this.lineCap;this.o.cursor&&(sat=eat-this.cursorExt)&&(eat=eat+this.cursorExt);c.beginPath();c.strokeStyle=this.o.bgColor;c.arc(this.xy,this.xy,this.radius,this.endAngle,this.startAngle,true);c.stroke();if(this.o.displayPrevious){ea=this.startAngle+this.angle(this.v);sa=this.startAngle;this.o.cursor&&(sa=ea-this.cursorExt)&&(ea=ea+this.cursorExt);c.beginPath();c.strokeStyle=this.pColor;c.arc(this.xy,this.xy,this.radius,sa,ea,false);c.stroke();r=(this.cv==this.v)};c.beginPath();c.strokeStyle=r?this.o.fgColor:this.fgColor;c.arc(this.xy,this.xy,this.radius,sat,eat,false);c.stroke()};this.cancel=function(){this.val(this.v)}};$.fn.gjProgress=function(o){return this.each(function(){var d=new k.Dial();d.o=o;d.$=$(this);d.run()}).parent()}})(jQuery);(function(jQuery){var internal={};internal.tabCallbacks={};internal.tabClick=function(action){var $this=jQuery(this),data=$this.closest('ul').data('gjTabs');if(!data)return;internal.activateTab($this.attr('id'),data,action)};internal.activateTab=function(tab,data,action){tab=jQuery('#'+tab);if(!internal.precheck(tab))return;var tabId=tab.attr('id'),storageName='activeTab';tab.closest('ul').find('li').each(function(){var elem=jQuery(this),elemId=elem.attr('id');storageName+='__'+elemId;elem.removeClass('activeTab');if(!jQuery('#'+elemId+'Contents').length&&(gjUtil.inAdmin))alert('Tabs set up incorrectly!  There is no element with ID '+elemId+'Contents');jQuery('#'+elemId+'Contents').hide()});tab.addClass('activeTab');jQuery('#'+tabId+'Contents').show();if(typeof internal.tabCallbacks[tabId]==='function')internal.tabCallbacks[tabId](action);if(data.localStoragePersist)localStorage.setItem(storageName,tabId)};internal.precheck=function(elem){if(elem.hasClass('activeTab'))return false;return true};var methods={init:function(options){return this.each(function(){var $this=jQuery(this),data=$this.data('gjTabs');if(!data){var defaultPersist=!(typeof Storage==='undefined'||$this.hasClass('ignoreActiveCookie')||$this.hasClass('ignoreActiveStored'));$this.data('gjTabs',$this.extend({localStoragePersist:defaultPersist},options));data=$this.data('gjTabs')};var storageName='activeTab',activeTab=null;$this.find('li').each(function(){var elem=jQuery(this);elem.click(internal.tabClick);if(!elem.hasClass('activeTab')){var content=jQuery('#'+elem.attr('id')+'Contents');if(!content.length){alert('Page did not finish loading, or tabs may be set up incorrectly!  There is no content div with ID of '+elem.identify()+'Contents');return};content.hide()}else{activeTab=elem.attr('id');elem.removeClass('activeTab')};storageName+='__'+elem.attr('id')});if(data.localStoragePersist){var activeStored=localStorage.getItem(storageName);if(activeStored&&jQuery('#'+activeStored).length)activeTab=activeStored};if(activeTab&&jQuery('#'+activeTab).length)internal.activateTab(activeTab,data)})},onActive:function(callback){if(typeof callback!=='function')return this;internal.tabCallbacks[this.attr('id')]=callback;return this},precheck:function(callback){if(typeof callback==='undefined')return internal.precheck;if(typeof callback!=='function')return;internal.precheck=callback;return this}};jQuery.fn.gjTabs=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments)}else jQuery.error('Method '+method+' does not exist on jQuery.gjTabs')}}(jQuery));(function($){var supportedCSS,supportedCSSOrigin,styles=document.getElementsByTagName("head")[0].style,toCheck="transformProperty WebkitTransform OTransform msTransform MozTransform".split(" ");for(var a=0;a<toCheck.length;a++)if(styles[toCheck[a]]!==undefined)supportedCSS=toCheck[a];if(supportedCSS){supportedCSSOrigin=supportedCSS.replace(/[tT]ransform/,"TransformOrigin");if(supportedCSSOrigin[0]=="T")supportedCSSOrigin[0]="t"};eval('IE = "v"=="\v"');jQuery.fn.extend({rotate:function(parameters){if(this.length===0||typeof parameters=="undefined")return;if(typeof parameters=="number")parameters={angle:parameters};var returned=[];for(var i=0,i0=this.length;i<i0;i++){var element=this.get(i);if(!element.Wilq32||!element.Wilq32.PhotoEffect){var paramClone=$.extend(true,{},parameters),newRotObject=new Wilq32.PhotoEffect(element,paramClone)._rootObj;returned.push($(newRotObject))}else element.Wilq32.PhotoEffect._handleRotation(parameters)};return returned},getRotateAngle:function(){var ret=[];for(var i=0,i0=this.length;i<i0;i++){var element=this.get(i);if(element.Wilq32&&element.Wilq32.PhotoEffect)ret[i]=element.Wilq32.PhotoEffect._angle};return ret},stopRotate:function(){for(var i=0,i0=this.length;i<i0;i++){var element=this.get(i);if(element.Wilq32&&element.Wilq32.PhotoEffect)clearTimeout(element.Wilq32.PhotoEffect._timer)}}});Wilq32=window.Wilq32||{};Wilq32.PhotoEffect=(function(){if(supportedCSS){return function(img,parameters){img.Wilq32={PhotoEffect:this};this._img=this._rootObj=this._eventObj=img;this._handleRotation(parameters)}}else return function(img,parameters){this._img=img;this._onLoadDelegate=[parameters];this._rootObj=document.createElement('span');this._rootObj.style.display="inline-block";this._rootObj.Wilq32={PhotoEffect:this};img.parentNode.insertBefore(this._rootObj,img);if(img.complete){this._Loader()}else{var self=this;jQuery(this._img).bind("load",function(){self._Loader()})}}})();Wilq32.PhotoEffect.prototype={_setupParameters:function(parameters){this._parameters=this._parameters||{};if(typeof this._angle!=="number")this._angle=0;if(typeof parameters.angle==="number")this._angle=parameters.angle;this._parameters.animateTo=(typeof parameters.animateTo==="number")?(parameters.animateTo):(this._angle);this._parameters.step=parameters.step||this._parameters.step||null;this._parameters.easing=parameters.easing||this._parameters.easing||this._defaultEasing;this._parameters.duration=parameters.duration||this._parameters.duration||1e3;this._parameters.callback=parameters.callback||this._parameters.callback||this._emptyFunction;this._parameters.center=parameters.center||this._parameters.center||["50%","50%"];if(typeof this._parameters.center[0]=="string"){this._rotationCenterX=(parseInt(this._parameters.center[0],10)/100)*this._imgWidth*this._aspectW}else this._rotationCenterX=this._parameters.center[0];if(typeof this._parameters.center[1]=="string"){this._rotationCenterY=(parseInt(this._parameters.center[1],10)/100)*this._imgHeight*this._aspectH}else this._rotationCenterY=this._parameters.center[1];if(parameters.bind&&parameters.bind!=this._parameters.bind)this._BindEvents(parameters.bind)},_emptyFunction:function(){},_defaultEasing:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},_handleRotation:function(parameters,dontcheck){if(!supportedCSS&&!this._img.complete&&!dontcheck){this._onLoadDelegate.push(parameters);return};this._setupParameters(parameters);if(this._angle==this._parameters.animateTo){this._rotate(this._angle)}else this._animateStart()},_BindEvents:function(events){if(events&&this._eventObj){if(this._parameters.bind){var oldEvents=this._parameters.bind;for(var a in oldEvents)if(oldEvents.hasOwnProperty(a))jQuery(this._eventObj).unbind(a,oldEvents[a])};this._parameters.bind=events;for(var a in events)if(events.hasOwnProperty(a))jQuery(this._eventObj).bind(a,events[a])}},_Loader:(function(){if(IE){return function(){var width=this._img.width,height=this._img.height;this._imgWidth=width;this._imgHeight=height;this._img.parentNode.removeChild(this._img);this._vimage=this.createVMLNode('image');this._vimage.src=this._img.src;this._vimage.style.height=height+"px";this._vimage.style.width=width+"px";this._vimage.style.position="absolute";this._vimage.style.top="0px";this._vimage.style.left="0px";this._aspectW=this._aspectH=1;this._container=this.createVMLNode('group');this._container.style.width=width;this._container.style.height=height;this._container.style.position="absolute";this._container.style.top="0px";this._container.style.left="0px";this._container.setAttribute('coordsize',width-1+','+(height-1));this._container.appendChild(this._vimage);this._rootObj.appendChild(this._container);this._rootObj.style.position="relative";this._rootObj.style.width=width+"px";this._rootObj.style.height=height+"px";this._rootObj.setAttribute('id',this._img.getAttribute('id'));this._rootObj.className=this._img.className;this._eventObj=this._rootObj;var parameters;while(parameters=this._onLoadDelegate.shift())this._handleRotation(parameters,true)}}else return function(){this._rootObj.setAttribute('id',this._img.getAttribute('id'));this._rootObj.className=this._img.className;this._imgWidth=this._img.naturalWidth;this._imgHeight=this._img.naturalHeight;var _widthMax=Math.sqrt((this._imgHeight)*(this._imgHeight)+(this._imgWidth)*(this._imgWidth));this._width=_widthMax*3;this._height=_widthMax*3;this._aspectW=this._img.offsetWidth/this._img.naturalWidth;this._aspectH=this._img.offsetHeight/this._img.naturalHeight;this._img.parentNode.removeChild(this._img);this._canvas=document.createElement('canvas');this._canvas.setAttribute('width',this._width);this._canvas.style.position="relative";this._canvas.style.left=-this._img.height*this._aspectW+"px";this._canvas.style.top=-this._img.width*this._aspectH+"px";this._canvas.Wilq32=this._rootObj.Wilq32;this._rootObj.appendChild(this._canvas);this._rootObj.style.width=this._img.width*this._aspectW+"px";this._rootObj.style.height=this._img.height*this._aspectH+"px";this._eventObj=this._canvas;this._cnv=this._canvas.getContext('2d');var parameters;while(parameters=this._onLoadDelegate.shift())this._handleRotation(parameters,true)}})(),_animateStart:function(){if(this._timer)clearTimeout(this._timer);this._animateStartTime=+new Date();this._animateStartAngle=this._angle;this._animate()},_animate:function(){var actualTime=+new Date(),checkEnd=actualTime-this._animateStartTime>this._parameters.duration;if(checkEnd&&!this._parameters.animatedGif){clearTimeout(this._timer)}else{if(this._canvas||this._vimage||this._img){var angle=this._parameters.easing(0,actualTime-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration);this._rotate((~~(angle*10))/10)};if(this._parameters.step)this._parameters.step(this._angle);var self=this;this._timer=setTimeout(function(){self._animate.call(self)},10)};if(this._parameters.callback&&checkEnd){this._angle=this._parameters.animateTo;this._rotate(this._angle);this._parameters.callback.call(this._rootObj)}},_rotate:(function(){var rad=Math.PI/180;if(IE){return function(angle){this._angle=angle;this._container.style.rotation=(angle%360)+"deg";this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+"px";this._vimage.style.left=-(this._rotationCenterX-this._imgWidth/2)+"px";this._container.style.top=this._rotationCenterY-this._imgHeight/2+"px";this._container.style.left=this._rotationCenterX-this._imgWidth/2+"px"}}else if(supportedCSS){return function(angle){this._angle=angle;this._img.style[supportedCSS]="rotate("+(angle%360)+"deg)";this._img.style[supportedCSSOrigin]=this._parameters.center.join(" ")}}else return function(angle){this._angle=angle;angle=(angle%360)*rad;this._canvas.width=this._width;this._canvas.height=this._height;this._cnv.translate(this._imgWidth*this._aspectW,this._imgHeight*this._aspectH);this._cnv.translate(this._rotationCenterX,this._rotationCenterY);this._cnv.rotate(angle);this._cnv.translate(-this._rotationCenterX,-this._rotationCenterY);this._cnv.scale(this._aspectW,this._aspectH);this._cnv.drawImage(this._img,0,0)}})()};if(IE)Wilq32.PhotoEffect.prototype.createVMLNode=(function(){document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!document.namespaces.rvml&&document.namespaces.add("rvml","urn:schemas-microsoft-com:vml");return function(tagName){return document.createElement('<rvml:'+tagName+' class="rvml">')}}catch(e){return function(tagName){return document.createElement('<'+tagName+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}})()})(jQuery);var addonNavigation={init:function(){jQuery('.addonNavigation_regionSelect').change(function(){addonNavigation.selectObserve(this)});jQuery('.geographic_navigation_changeLink').click(function(event){addonNavigation.changeRegionClick(this,event)})},selectObserve:function(element){var je=jQuery(element);if(je.val()==0&&je.prev().length)je=je.prev();jQuery.post('AJAX.php?controller=addon_geographic_navigation&action=selectRegion',{region_id:je.val(),fieldName:je.prop('name')},function(returned){je.parent().html(returned)},'html')},navChangeBox:null,navTriggeringElement:null,triggerTop:0,triggerLeft:0,getParams:{},changeRegionClick:function(element,event){var je=jQuery(element);event.preventDefault();addonNavigation.navChangeBox=jQuery("<div id='geoNavChangeBox' style='display: none;'>Loading...</div>");addonNavigation.navTriggeringElement=je;var offsets=je.offset();addonNavigation.triggerTop=offsets.top;addonNavigation.triggerLeft=offsets.left;je.css('visibility','hidden');jQuery("body").append(addonNavigation.navChangeBox);addonNavigation.absolutizeNavBox();addonNavigation.navChangeBox.show();jQuery.post('AJAX.php?controller=addon_geographic_navigation&action=chooseRegionBox',addonNavigation.getParams,function(returned){addonNavigation.handleChangeBox(returned)},'html')},absolutizeNavBox:function(){var box=jQuery(addonNavigation.navChangeBox);box.css("position","absolute");box.css("top",addonNavigation.triggerTop+'px');var newLeft=addonNavigation.triggerLeft,windowWidth=jQuery(window).width(),boxWidth=box.width();if(addonNavigation.triggerLeft+boxWidth>windowWidth){newLeft=windowWidth-boxWidth;newLeft-=40};box.css("left",newLeft+'px')},handleChangeBox:function(boxContents){addonNavigation.navChangeBox.html(boxContents);addonNavigation.absolutizeNavBox();jQuery('.chooseNavCancel').click(addonNavigation.closeChangeBox);jQuery('.narrowRegionLink').click(function(){addonNavigation.changeChooseRegion(this)}).dblclick(function(event){addonNavigation.changeDblClick(this,event)});jQuery('.narrowRegionSelect').change(function(){addonNavigation.changeChooseRegion(this)})},closeChangeBox:function(){addonNavigation.navChangeBox.remove();addonNavigation.navTriggeringElement.css('visibility','')},changeChooseRegion:function(element){var je=jQuery(element),regionId=0;if(je.hasClass('narrowRegionLink')){regionId=je.next().val()}else regionId=je.val();var params=addonNavigation.getParams;params.region=regionId;jQuery.post('AJAX.php?controller=addon_geographic_navigation&action=chooseRegionBox',params,function(returned){addonNavigation.handleChangeBox(returned)},'html')},changeDblClick:function(element,event){event.preventDefault();addonNavigation.closeChangeBox();window.location=jQuery(element).next().next().val()}};jQuery(document).ready(addonNavigation.init)<br />
<b>Warning</b>:  Cannot modify header information - headers already sent by (output started at /home/exportco/domains/exportcar.com/public_html/classes/adodb/drivers/adodb-mysql.inc.php:424) in <b>/home/exportco/domains/exportcar.com/public_html/geo_templates/min.php</b> on line <b>181</b><br />
<br />
<b>Warning</b>:  Cannot modify header information - headers already sent by (output started at /home/exportco/domains/exportcar.com/public_html/classes/adodb/drivers/adodb-mysql.inc.php:424) in <b>/home/exportco/domains/exportcar.com/public_html/geo_templates/min.php</b> on line <b>182</b><br />
<br />
<b>Warning</b>:  Cannot modify header information - headers already sent by (output started at /home/exportco/domains/exportcar.com/public_html/classes/adodb/drivers/adodb-mysql.inc.php:424) in <b>/home/exportco/domains/exportcar.com/public_html/geo_templates/min.php</b> on line <b>183</b><br />

/* ON-FLY - LOADED */
